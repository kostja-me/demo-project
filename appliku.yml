build_settings:
  build_image: python-3.13-node-20.18
  build_command: npm i && npm run tailwind:build
  environment_variables:
    - name: APPLIKU
      value: "true"
    - name: DATABASE_URL
      fromDatabase:
        name: db
        property: connectionURL
    - name: REDIS_URL
      fromDatabase:
        name: redis
        property: privateConnectionURL

services:
  web:
    command: bash web.sh
  worker:
    command: bash celery-worker.sh
  beat:
    command: bash celery-beat.sh
  release:
    command: bash release.sh

databases:
  db:
    type: postgresql_17
  db2:
    type: postgresql_17
  redis:
    type: redis_7
